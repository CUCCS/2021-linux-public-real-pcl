# 实验报告三

##### 实验内容：动手操作systemd，利用asciinema录屏，并完成自查清单

---
##### 实验结果：

##### [命令篇]
[![asciicast](https://asciinema.org/a/404076.svg)](https://asciinema.org/a/404076)

##### [实战篇]
[![asciicast](https://asciinema.org/a/404099.svg)](https://asciinema.org/a/404099)

---

### 自查清单
1.如何添加一个用户并使其具备sudo执行程序的权限？

```shell
#添加用户
sudo adduser username 

#赋予sudo权限
sudo usermod -a username -G sudo #将用户添加到sudo组
sudo adduser username sudo #直接赋予权限
```

2.如何将一个用户添加到一个用户组？

```shell
sudo adduser [username] [teamname]
或者
sudo usermod -a [username] -G [teamname]
```

3.如何查看当前系统的分区表和文件系统详细信息？

```shell
#查看当前系统分区表: 
sudo sfdisk -l

#查看文件系统详情:
df -h
```

4.如何实现开机自动挂载Virtualbox的共享目录分区？

```shell
#在Virtualbox的共享文件夹中添加本地文件，设置自动挂载和固定分配

#将sr0挂载到/media/cdrom目录
sudo mount /dev/sr0 /media/cdrom

#安装相关配置，进行升级
sudo apt-get install build-essential gcc make perl dkms

#安装增强功能并重启
sudo /media/cdrom/./VBoxLinuxAdditions.run

reboot

#检验是否安装成功 
lsmod | grep vboxsf

#创建共享目录  
sudo mkdir /mnt/share

#将本地文件夹挂载到指定目录  
sudo mount -t vboxsf sharefilename/mnt/shard

```

5.基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？

```shell
#动态扩容  
lvextend -L +size /dev/dir
#缩减容量  
lvextend -L -size /dev/dir
```

6.如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？
```shell
#打开所需脚本的配置文件，添加以下命令
ExecStartPost=[MY_SATART_SCRIPT_PATH]  
ExecStopPost=[MY_STOP_SCRIPT_PATH]  

#重新加载配置文件
sudo systemctl daemon-reload

#重启网络服务
sudo systemctl restart systemd-network.service

#关闭服务
sudo systemctl stop systemd-network.service

```

7.如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现杀不死？
```shell
#创建并编辑一个脚本配置文件，按i输入一下内容：
[Unit]
Description=KILL ME PLEASE
 
[Service]
Type=simple
ExecStart=MY_SCRIPT_PATH
ExecStopPost=MY_SCRIPT_PATH
Restart=always
RestartSec=1
RemainAfterExit=yes
 
[Install]
WantedBy=multi-user.target

#重新加载配置文件
sudo systemctl daemon-reload

#重启KILLME服务
sudo systemctl restart KILLME.service

#查询服务状态是否为active
sudo systemctl is-active KILLME.service

#尝试杀死服务
sudo systemctl kill KILLME.service

#查询服务状态是否为active来验证服务能否杀死
sudo systemctl is-active KILLME.service

#命令重启，但是由于服务无法杀死而重启困难
reboot

```
---